

                           Bismark Methylation Extractor

                         Bismark Extractor Version: v0.23.1
              Copyright 2010-20 Felix Krueger, Babraham Bioinformatics
                www.bioinformatics.babraham.ac.uk/projects/bismark/
                     https://github.com/FelixKrueger/Bismark



 *** Bismark methylation extractor version v0.23.1 ***

Output will be written into the directory: /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/

Summarising Bismark methylation extractor parameters:
===============================================================
Bismark single-end SAM format specified (default)
Number of cores to be used: 8
Output path specified as: /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/


Summarising bedGraph parameters:
===============================================================
Generating additional output in bedGraph and coverage format
bedGraph format:	<Chromosome> <Start Position> <End Position> <Methylation Percentage>
coverage format:	<Chromosome> <Start Position> <End Position> <Methylation Percentage> <count methylated> <count non-methylated>

Using a cutoff of 1 read(s) to report cytosine positions
Reporting and sorting cytosine methylation information in CpG context only (default)
The bedGraph UNIX sort command will use the following memory setting:	'2G'. Temporary directory used for sorting is the output directory


Summarising genome-wide cytosine methylation report parameters:
===============================================================
Generating comprehensive genome-wide cytosine report
(output format: <Chromosome> <Position> <Strand> <count methylated> <count non-methylated>  <C-context>  <trinucleotide context> )
Reporting cytosine methylation in CpG context only (default)
Using 1-based genomic coordinates (default)
Genome folder was specified as ./input/bismarkIndex/

Checking file >>input/test_1.clumped_bismark_bt2_pe.bam<< for signs of file truncation...

Writing result file containing methylation information for C in CpG context from the original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CpG context from the complementary to original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CpG context from the complementary to original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CpG context from the original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OB_test_1.clumped_bismark_bt2_pe.txt

Writing result file containing methylation information for C in CHG context from the original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHG context from the complementary to original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHG context from the complementary to original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOB_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHG context from the original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OB_test_1.clumped_bismark_bt2_pe.txt

Writing result file containing methylation information for C in CHH context from the original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHH context from the complementary to original top strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOT_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHH context from the complementary to original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOB_test_1.clumped_bismark_bt2_pe.txt
Writing result file containing methylation information for C in CHH context from the original bottom strand to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OB_test_1.clumped_bismark_bt2_pe.txt


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam


Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam

Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam

Now reading in Bismark result file input/test_1.clumped_bismark_bt2_pe.bam

skipping SAM header line:	@HD	VN:1.0	SO:unsorted
skipping SAM header line:	@SQ	SN:Chr1	LN:30427671
skipping SAM header line:	@SQ	SN:Chr2	LN:19698289
skipping SAM header line:	@SQ	SN:Chr3	LN:23459830
skipping SAM header line:	@SQ	SN:Chr4	LN:18585056
skipping SAM header line:	@SQ	SN:Chr5	LN:26975502
skipping SAM header line:	@SQ	SN:chloroplast	LN:154478
skipping SAM header line:	@SQ	SN:mitochondria	LN:366924
skipping SAM header line:	@PG	ID:Bismark	VN:v0.23.1	CL:"bismark ./input/bismarkIndex -1 input/test_1.clumped.fq.gz -2 input/test_2.clumped.fq.gz --multicore 8 -o ./output/ --temp_dir ./output/ --bowtie2"
skipping SAM header line:	@PG	ID:samtools	PN:samtools	PP:Bismark	VN:1.15.1	CL:/opt/conda/envs/bioinfo/bin/samtools view -bSh -
skipping SAM header line:	@PG	ID:samtools.1	PN:samtools	PP:samtools	VN:1.15.1	CL:/opt/conda/envs/bioinfo/bin/samtools view -h /home/rstudio/dkt/projects/aphid/exp/08_alignment_bismark_cumpified/output/test_1.clumped.fq.gz.temp.1_bismark_bt2_pe.bam
skipping SAM header line:	@PG	ID:samtools.2	PN:samtools	PP:samtools.1	VN:1.15.1	CL:/opt/conda/envs/bioinfo/bin/samtools view -bSh -
skipping SAM header line:	@PG	ID:samtools.3	PN:samtools	PP:samtools.2	VN:1.15.1	CL:/opt/conda/envs/bioinfo/bin/samtools view -h input/test_1.clumped_bismark_bt2_pe.bam
Finished processing child process. Exiting..
Finished processing child process. Exiting..
Now waiting for all child processes to complete
Finished processing child process. Exiting..
Finished processing child process. Exiting..
Finished processing child process. Exiting..
Finished processing child process. Exiting..
Finished processing child process. Exiting..

Merging individual splitting reports into overall report: '/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt'
Merging from these individual files:
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.1
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.2
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.3
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.4
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.5
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.6
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.7
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.8


Processed 2824 lines in total
Total number of methylation call strings processed: 2824

Final Cytosine Methylation Report
=================================
Total number of C's analysed:	57244

Total methylated C's in CpG context:	1204
Total methylated C's in CHG context:	467
Total methylated C's in CHH context:	1354

Total C to T conversions in CpG context:	6329
Total C to T conversions in CHG context:	6697
Total C to T conversions in CHH context:	41193

C methylated in CpG context:	16.0%
C methylated in CHG context:	6.5%
C methylated in CHH context:	3.2%



Merging individual M-bias reports into overall M-bias statistics from these 8 individual files:
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.1.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.2.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.3.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.4.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.5.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.6.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.7.mbias
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/test_1.clumped_bismark_bt2_pe_splitting_report.txt.8.mbias

Determining maximum read length for M-Bias plot
Maximum read length of Read 1: 151

Determining maximum read length for M-Bias plot
Maximum read length of Read 1: 151

Deleting unused files ...

/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOT_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OB_test_1.clumped_bismark_bt2_pe.txt contains data ->	kept


Using these input files: /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OB_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_CTOB_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHG_OB_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOT_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_CTOB_test_1.clumped_bismark_bt2_pe.txt /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CHH_OB_test_1.clumped_bismark_bt2_pe.txt

Summary of parameters for bismark2bedGraph conversion:
======================================================
bedGraph output:		test_1.clumped_bismark_bt2_pe.bedGraph.gz
output directory:		>/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/<
remove whitespaces:		no
CX context:			no (CpG context only, default)
No-header selected:		no
Sorting method:			Unix sort-based (smaller memory footprint, but slower)
Sort buffer size:		2G
Coverage threshold:		1
=============================================================================
Methylation information will now be written into a bedGraph and coverage file
=============================================================================

Using the following files as Input:
/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OT_test_1.clumped_bismark_bt2_pe.txt	/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt	/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt	/home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/CpG_OB_test_1.clumped_bismark_bt2_pe.txt

Writing bedGraph to file: test_1.clumped_bismark_bt2_pe.bedGraph.gz
Also writing out a coverage file including counts methylated and unmethylated residues to file: test_1.clumped_bismark_bt2_pe.bismark.cov.gz

Changed directory to /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/
Now writing methylation information for file >>CpG_OT_test_1.clumped_bismark_bt2_pe.txt<< to individual files for each chromosome
Finished writing out individual chromosome files for CpG_OT_test_1.clumped_bismark_bt2_pe.txt
Now writing methylation information for file >>CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt<< to individual files for each chromosome
Finished writing out individual chromosome files for CpG_CTOT_test_1.clumped_bismark_bt2_pe.txt
Now writing methylation information for file >>CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt<< to individual files for each chromosome
Finished writing out individual chromosome files for CpG_CTOB_test_1.clumped_bismark_bt2_pe.txt
Now writing methylation information for file >>CpG_OB_test_1.clumped_bismark_bt2_pe.txt<< to individual files for each chromosome
Finished writing out individual chromosome files for CpG_OB_test_1.clumped_bismark_bt2_pe.txt

Collecting temporary chromosome file information... Processing the following input file(s):
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr2.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrchloroplast.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr3.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr5.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr1.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr4.methXtractor.temp
CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrmitochondria.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr1.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr1.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr2.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr2.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr3.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr3.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr4.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr4.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr5.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrChr5.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrchloroplast.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrchloroplast.methXtractor.temp

Sorting input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrmitochondria.methXtractor.temp by positions (using -S of 2G)
Successfully deleted the temporary input file CpG_OT_test_1.clumped_bismark_bt2_pe.txt.chrmitochondria.methXtractor.temp

Finished BedGraph conversion ...

Output will be written into the directory: /home/rstudio/dkt/projects/aphid/exp/09_methylation_extract_bismark_clumped/output/test/
Failed to move to './input/bismarkIndex/'. Make sure the path to the genome folder is correct, and respecify!



Finished generating genome-wide cytosine report

